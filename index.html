<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detektif 100 Level - Sistem Checkpoint</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4e54c8;
            --secondary-color: #8f94fb;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --card-bg: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --choice-bg: #f0f4ff;
            --choice-hover: #e0e8ff;
            --timer-red: #ff4757;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background-color: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
            position: relative;
        }

        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .level-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .level-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .difficulty {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .hearts {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }

        .heart {
            color: #ff4757;
            margin: 0 5px;
            font-size: 1.5rem;
        }

        .heart.lost {
            color: #ccc;
        }

        .character {
            font-size: 4rem;
            margin: 15px 0;
        }

        .story-container {
            padding: 25px;
            background-color: var(--bg-color);
            border-radius: 10px;
            margin: 15px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .story-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .clue-box {
            background-color: #f0f4ff;
            border-left: 4px solid var(--primary-color);
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
        }

        .choices-container {
            padding: 0 25px 25px;
        }

        .choices-title {
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .choice {
            background-color: var(--choice-bg);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .choice:hover {
            background-color: var(--choice-hover);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .choice.correct {
            background-color: #4caf50;
            color: white;
        }

        .choice.incorrect {
            background-color: #ff4757;
            color: white;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-content h2 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .modal-content p {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .name-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1rem;
            text-align: center;
        }

        .name-input:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .start-button, .next-button {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-button:hover, .next-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .result-modal {
            text-align: center;
        }

        .result-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .success .result-icon {
            color: #4caf50;
        }

        .failure .result-icon {
            color: #ff4757;
        }

        .hint-button {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .hints-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            display: none;
        }

        .hint-item {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
        }

        .hint-item:before {
            content: "üí°";
            position: absolute;
            left: 0;
        }

        .game-complete {
            text-align: center;
            padding: 30px;
        }

        .game-complete-icon {
            font-size: 5rem;
            color: gold;
            margin-bottom: 20px;
        }

        .checkpoint-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 600px) {
            .character {
                font-size: 3rem;
            }
            
            .story-text {
                font-size: 1rem;
            }
            
            .choice {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Modal Input Nama -->
    <div class="modal-overlay" id="nameModal">
        <div class="modal-content">
            <h2><i class="fas fa-user-secret"></i> Identitas Detektif</h2>
            <p>Masukkan nama detektif Anda untuk memulai misi rahasia!</p>
            <input type="text" class="name-input" id="agentNameInput" placeholder="Nama Detektif" maxlength="20">
            <button class="start-button" id="startButton">Mulai Misi</button>
        </div>
    </div>

    <!-- Game Container -->
    <div class="game-container" id="gameContainer" style="display: none;">
        <div class="header">
            <div class="level-info">
                <div class="level-title">Level <span id="levelNumber">1</span> dari 100</div>
                <div class="difficulty" id="difficulty">Mudah</div>
            </div>
            <div class="hearts" id="heartsContainer">
                <i class="fas fa-heart heart"></i>
                <i class="fas fa-heart heart"></i>
                <i class="fas fa-heart heart"></i>
            </div>
            <div class="character" id="character">üïµÔ∏è</div>
        </div>

        <div class="story-container">
            <div class="story-text" id="storyText"></div>
            <div class="clue-box" id="clueBox"></div>
        </div>

        <div class="choices-container">
            <div class="choices-title">Pilih jawaban yang tepat:</div>
            <div id="choicesList"></div>
            <button class="hint-button" id="hintButton">Tunjukkan Petunjuk</button>
            <div class="hints-container" id="hintsContainer"></div>
            <div class="checkpoint-info" id="checkpointInfo">Checkpoint: Level 1</div>
        </div>
    </div>

    <!-- Modal Hasil -->
    <div class="modal-overlay" id="resultModal" style="display: none;">
        <div class="modal-content result-modal" id="resultContent">
            <div class="result-icon" id="resultIcon"></div>
            <h2 id="resultTitle"></h2>
            <p id="resultMessage"></p>
            <button class="next-button" id="nextButton">Lanjutkan</button>
        </div>
    </div>

    <!-- Game Selesai -->
    <div class="modal-overlay" id="completeModal" style="display: none;">
        <div class="modal-content game-complete">
            <div class="game-complete-icon">üèÜ</div>
            <h2>Selamat, Detektif <span id="playerNameComplete"></span>!</h2>
            <p>Anda telah berhasil menyelesaikan semua 100 teka-teki.</p>
            <p>Keterampilan detektif Anda luar biasa!</p>
            <button class="start-button" id="restartButton">Main Lagi</button>
        </div>
    </div>

    <script>
        // Data level game (contoh 5 level pertama)
        const levels = [
            { level: 1, character: "üïµÔ∏è", story: "Seorang pria ditemukan tewas di tengah padang pasir. Di sekitarnya hanya ada pecahan kaca. Apa yang terjadi?", clue: "Pecahan kaca adalah kunci misteri ini.", choices: [
                "Dia jatuh dari pesawat", 
                "Dibunuh dengan senjata pecahan kaca", 
                "Kecelakaan mobil", 
                "Terkait dengan balon udara"
            ], correctChoice: 0, difficulty: "Mudah", success: "Benar! Dia jatuh dari pesawat dan kaca adalah jendela pesawat yang pecah.", failure: "Salah! Pikirkan tentang objek yang bisa pecah dan meninggalkan kaca.", hints: [
                "Padang pasir luas",
                "Tidak ada jejak kendaraan",
                "Pecahan kaca tersebar"
            ] },
            { level: 2, character: "üîç", story: "Seorang wanita meninggal di kamar mandi dengan luka di kepala. Ada kursi dan kaca pecah. Apa yang terjadi?", clue: "Perhatikan posisi benda-benda di sekitar.", choices: [
                "Dia dibunuh kemudian diatur seperti bunuh diri",
                "Dia mencoba mengambil sesuatu yang tinggi",
                "Tergelincir dan terbentur",
                "Diserang oleh penyusup"
            ], correctChoice: 1, difficulty: "Mudah", success: "Benar! Dia berdiri di kursi untuk mengambil sesuatu, jatuh, dan pecahan kaca melukainya.", failure: "Salah! Perhatikan benda-benda yang ada dan posisinya.", hints: [
                "Kaca pecah di lantai",
                "Kursi berada di dekatnya",
                "Tidak ada tanda-tanda perampokan"
            ] },
            { level: 3, character: "üìö", story: "Seorang pria meninggal di perpustakaan dengan buku di sekitarnya. Apa yang terjadi?", clue: "Buku bukanlah penyebab langsung kematiannya.", choices: [
                "Dia terbunuh oleh racun di buku",
                "Jatuh dari tangga saat mengambil buku",
                "Dikeroyok perampok",
                "Kecelakaan karena rak buku rubuh"
            ], correctChoice: 3, difficulty: "Mudah", success: "Benar! Rak buku rubuh dan menimpanya hingga tewas.", failure: "Salah! Perhatikan jumlah buku yang berserakan.", hints: [
                "Buku berserakan di lantai",
                "Posisi jenazah di bawah rak buku",
                "Tidak ada luka senjata tajam"
            ] },
            { level: 4, character: "üè¢", story: "Sebuah perusahaan teknologi melaporkan pencurian data penting. Tidak ada jejak peretasan di sistem. Apa yang terjadi?", clue: "Pencurian tidak selalu dilakukan dari luar.", choices: [
                "Serangan siber tingkat lanjut",
                "Karyawan dalam perusahaan yang berkhianat",
                "Kesalahan sistem yang menyebabkan data terhapus",
                "Kebocoran data tidak disengaja"
            ], correctChoice: 1, difficulty: "Sedang", success: "Benar! Seorang karyawan dalam perusahaan yang mencuri data penting.", failure: "Salah! Perhatikan bahwa tidak ada jejak peretasan di sistem.", hints: [
                "Tidak ada jejak peretasan",
                "Data penting yang hilang",
                "Akses internal diperlukan"
            ] },
            { level: 5, character: "üåÉ", story: "Sebuah patung berharga hilang dari museum. Kamera pengawas hanya mencatat kegelapan selama 5 menit. Apa yang terjadi?", clue: "Kegelapan bukan kebetulan.", choices: [
                "Pemadaman listrik yang direncanakan",
                "Kamera dimanipulasi",
                "Patung disembunyikan oleh kurator",
                "Pencuri menggunakan teknologi siluman"
            ], correctChoice: 0, difficulty: "Sedang", success: "Benar! Pencuri menyebabkan pemadaman listrik untuk mencuri patung.", failure: "Salah! Perhatikan bahwa kamera hanya mencatat kegelapan.", hints: [
                "Kegelapan selama 5 menit",
                "Tidak ada aktivitas mencurigakan",
                "Patung berharga"
            ] }
            // Tambahkan level lainnya sesuai kebutuhan
        ];

        // Variabel game state
        let currentLevel = 0;
        let playerName = "";
        let hearts = 3;
        let gameActive = false;
        let checkpoint = 0; // Level terakhir yang berhasil diselesaikan

        // Elemen DOM
        const nameModal = document.getElementById('nameModal');
        const gameContainer = document.getElementById('gameContainer');
        const agentNameInput = document.getElementById('agentNameInput');
        const startButton = document.getElementById('startButton');
        const levelNumber = document.getElementById('levelNumber');
        const difficulty = document.getElementById('difficulty');
        const character = document.getElementById('character');
        const storyText = document.getElementById('storyText');
        const clueBox = document.getElementById('clueBox');
        const choicesList = document.getElementById('choicesList');
        const heartsContainer = document.getElementById('heartsContainer');
        const resultModal = document.getElementById('resultModal');
        const resultContent = document.getElementById('resultContent');
        const resultIcon = document.getElementById('resultIcon');
        const resultTitle = document.getElementById('resultTitle');
        const resultMessage = document.getElementById('resultMessage');
        const nextButton = document.getElementById('nextButton');
        const hintButton = document.getElementById('hintButton');
        const hintsContainer = document.getElementById('hintsContainer');
        const completeModal = document.getElementById('completeModal');
        const playerNameComplete = document.getElementById('playerNameComplete');
        const restartButton = document.getElementById('restartButton');
        const checkpointInfo = document.getElementById('checkpointInfo');

        // Event Listeners
        startButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', nextLevel);
        hintButton.addEventListener('click', toggleHints);
        restartButton.addEventListener('click', restartGame);

        // Fungsi memulai game
        function startGame() {
            playerName = agentNameInput.value.trim() || "Detektif";
            if (playerName) {
                nameModal.style.display = 'none';
                gameContainer.style.display = 'block';
                gameActive = true;
                
                // Coba muat progress dari localStorage
                loadProgress();
                
                loadLevel(currentLevel);
            }
        }

        // Fungsi memuat level
        function loadLevel(levelIndex) {
            if (levelIndex >= levels.length) {
                endGame();
                return;
            }

            const level = levels[levelIndex];
            levelNumber.textContent = level.level;
            difficulty.textContent = level.difficulty;
            character.textContent = level.character;
            storyText.textContent = level.story;
            clueBox.textContent = "Petunjuk: " + level.clue;
            
            // Update info checkpoint
            checkpointInfo.textContent = `Checkpoint: Level ${checkpoint + 1}`;

            // Kosongkan pilihan sebelumnya
            choicesList.innerHTML = '';
            
            // Tambahkan pilihan
            level.choices.forEach((choice, index) => {
                const choiceElement = document.createElement('div');
                choiceElement.className = 'choice';
                choiceElement.textContent = choice;
                choiceElement.addEventListener('click', () => checkAnswer(index, level));
                choicesList.appendChild(choiceElement);
            });

            // Sembunyikan petunjuk
            hintsContainer.innerHTML = '';
            hintsContainer.style.display = 'none';
            
            // Tambahkan petunjuk jika ada
            if (level.hints && level.hints.length > 0) {
                level.hints.forEach(hint => {
                    const hintItem = document.createElement('div');
                    hintItem.className = 'hint-item';
                    hintItem.textContent = hint;
                    hintsContainer.appendChild(hintItem);
                });
                hintButton.style.display = 'block';
            } else {
                hintButton.style.display = 'none';
            }

            // Update tampilan hati
            updateHearts();
        }

        // Fungsi memeriksa jawaban
        function checkAnswer(choiceIndex, level) {
            if (!gameActive) return;

            const choices = document.querySelectorAll('.choice');
            gameActive = false;

            if (choiceIndex === level.correctChoice) {
                // Jawaban benar
                choices[choiceIndex].classList.add('correct');
                
                // Update checkpoint jika melewati level sebelumnya
                if (currentLevel >= checkpoint) {
                    checkpoint = currentLevel;
                    saveProgress(); // Simpan progress
                }
                
                showResult(true, level.success);
            } else {
                // Jawaban salah
                choices[choiceIndex].classList.add('incorrect');
                choices[level.correctChoice].classList.add('correct');
                
                // Kurangi nyawa
                hearts--;
                updateHearts();
                
                if (hearts <= 0) {
                    // Game over - kembali ke checkpoint
                    setTimeout(() => {
                        showResult(false, `Game Over! Anda akan kembali ke checkpoint (Level ${checkpoint + 1}).`, true);
                    }, 1500);
                } else {
                    setTimeout(() => {
                        showResult(false, level.failure);
                    }, 1500);
                }
            }
        }

        // Fungsi menampilkan hasil
        function showResult(isSuccess, message, isGameOver = false) {
            resultModal.style.display = 'flex';
            
            if (isSuccess) {
                resultContent.className = 'modal-content result-modal success';
                resultIcon.innerHTML = '‚úì';
                resultTitle.textContent = 'Tepat Sekali!';
                resultMessage.textContent = message;
                nextButton.textContent = currentLevel < levels.length - 1 ? 'Lanjutkan' : 'Selesai';
            } else if (isGameOver) {
                resultContent.className = 'modal-content result-modal failure';
                resultIcon.innerHTML = '‚úó';
                resultTitle.textContent = 'Game Over';
                resultMessage.textContent = message;
                nextButton.textContent = 'Kembali ke Checkpoint';
            } else {
                resultContent.className = 'modal-content result-modal failure';
                resultIcon.innerHTML = '‚úó';
                resultTitle.textContent = 'Salah!';
                resultMessage.textContent = message;
                nextButton.textContent = 'Coba Lagi';
            }
        }

        // Fungsi level selanjutnya
        function nextLevel() {
            resultModal.style.display = 'none';
            
            if (hearts <= 0) {
                // Kembali ke checkpoint
                currentLevel = checkpoint;
                hearts = 3;
                gameActive = true;
                loadLevel(currentLevel);
                return;
            }
            
            // Jika jawaban benar, lanjut ke level berikutnya
            if (currentLevel < levels.length - 1) {
                currentLevel++;
                gameActive = true;
                loadLevel(currentLevel);
            } else {
                endGame();
            }
        }

        // Fungsi mengakhiri game
        function endGame() {
            gameContainer.style.display = 'none';
            completeModal.style.display = 'flex';
            playerNameComplete.textContent = playerName;
            
            // Reset progress
            localStorage.removeItem('detectiveGameProgress');
        }

        // Fungsi restart game
        function restartGame() {
            currentLevel = 0;
            checkpoint = 0;
            hearts = 3;
            gameActive = true;
            completeModal.style.display = 'none';
            resultModal.style.display = 'none';
            gameContainer.style.display = 'block';
            
            // Hapus progress yang disimpan
            localStorage.removeItem('detectiveGameProgress');
            
            loadLevel(currentLevel);
        }

        // Fungsi toggle petunjuk
        function toggleHints() {
            if (hintsContainer.style.display === 'block') {
                hintsContainer.style.display = 'none';
                hintButton.textContent = 'Tunjukkan Petunjuk';
            } else {
                hintsContainer.style.display = 'block';
                hintButton.textContent = 'Sembunyikan Petunjuk';
            }
        }

        // Fungsi update tampilan hati
        function updateHearts() {
            const heartIcons = heartsContainer.querySelectorAll('.heart');
            heartIcons.forEach((heart, index) => {
                if (index < hearts) {
                    heart.classList.remove('lost');
                } else {
                    heart.classList.add('lost');
                }
            });
        }

        // Fungsi menyimpan progress
        function saveProgress() {
            const progress = {
                level: currentLevel,
                checkpoint: checkpoint,
                hearts: hearts,
                playerName: playerName
            };
            localStorage.setItem('detectiveGameProgress', JSON.stringify(progress));
        }

        // Fungsi memuat progress
        function loadProgress() {
            const savedProgress = localStorage.getItem('detectiveGameProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentLevel = progress.level;
                checkpoint = progress.checkpoint;
                hearts = progress.hearts;
                playerName = progress.playerName;
                
                // Perbarui input nama dengan nama yang disimpan
                agentNameInput.value = playerName;
            }
        }

        // Fokus ke input nama saat halaman dimuat
        window.onload = function() {
            agentNameInput.focus();
        };
    </script>
</body>
</html>
